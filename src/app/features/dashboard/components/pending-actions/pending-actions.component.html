<div class="bg-white rounded-xl p-5 border border-gray-100 shadow-sm">
  <div class="flex items-center justify-between mb-4">
    <h3 class="text-lg font-semibold text-mlm-text">Pending Actions</h3>
    <a (click)="viewAll()" class="text-sm text-mlm-primary hover:text-brand-green-dark transition-colors cursor-pointer font-medium">View All</a>
  </div>

  <div class="grid grid-cols-2 gap-3">
    @for (action of displayActions; track action.type) {
      <button 
        (click)="openModal(action)"
        class="p-4 rounded-xl border border-gray-100 hover:border-mlm-green-200 hover:bg-mlm-green-50/30 transition-all text-left group">
        <div class="flex items-start justify-between mb-3">
          <div 
            class="w-10 h-10 rounded-lg flex items-center justify-center"
            [class]="action.iconBg">
            <i [class]="action.icon + ' ' + action.iconColor"></i>
          </div>
          <span 
            class="px-2 py-0.5 text-xs font-medium rounded-full"
            [class]="getUrgencyClass(action.urgency)">
            {{ action.count }}
          </span>
        </div>
        <p class="text-sm font-medium text-mlm-text group-hover:text-mlm-primary transition-colors">
          {{ action.label }}
        </p>
        <p class="text-xs text-mlm-secondary mt-1">
          Click to view details
        </p>
      </button>
    }
  </div>
</div>

<!-- Modal -->
<p-dialog 
  [(visible)]="modalVisible" 
  [header]="selectedAction?.label || 'Details'"
  [modal]="true"
  [style]="{width: '600px'}"
  [draggable]="false"
  [resizable]="false">
  
  @if (selectedAction) {
    <div class="mb-4">
      <p class="text-mlm-secondary">
        Showing {{ modalItems.length }} pending items requiring attention.
      </p>
    </div>

    <p-table [value]="modalItems" [tableStyle]="{'min-width': '100%'}" styleClass="p-datatable-sm">
      <ng-template #header>
        <tr>
          <th>ID</th>
          <th>Name</th>
          @if (selectedAction.type === 'withdrawals' || selectedAction.type === 'payments') {
            <th>Amount</th>
          }
          <th>Date</th>
          <th>Status</th>
        </tr>
      </ng-template>
      <ng-template #body let-item>
        <tr>
          <td class="font-mono text-sm">{{ item.id }}</td>
          <td>{{ item.name }}</td>
          @if (selectedAction.type === 'withdrawals' || selectedAction.type === 'payments') {
            <td class="font-medium">{{ item.amount }}</td>
          }
          <td class="text-mlm-secondary">{{ item.date }}</td>
          <td>
            <p-tag [value]="item.status" [severity]="getStatusSeverity(item.status)" [rounded]="true"></p-tag>
          </td>
        </tr>
      </ng-template>
    </p-table>

    <div class="flex justify-end gap-2 mt-4 pt-4 border-t border-gray-100">
      <button pButton label="Close" class="p-button-text" (click)="modalVisible = false"></button>
      <button pButton label="View All" icon="pi pi-external-link" class="p-button-primary" (click)="viewAll()"></button>
    </div>
  }
</p-dialog>
